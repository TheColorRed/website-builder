"use strict";var builder;!function(e){async function t(e,t={},r="get"){let n={method:r};"post"==r&&Object.keys(t).length>0?n.body=JSON.stringify(t):"get"==r&&Object.keys(t).length>0&&(e+="?"+Object.keys(t).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e])).join("&"));let a="",i=document.querySelector("meta[name=csrf]");i&&(a=i.content),n.headers={"X-Requested-With":"XMLHttpRequest"},a.length>0&&(n.headers["X-CSRF-Token"]=a);let l=await fetch(e,n),s=await l.text();try{return JSON.parse(s)}catch(e){return s}}async function r(e){let r="string"==typeof e?document.querySelector(e):e;if(!r.reportValidity())return;let n=new FormData(r),a={};return Array.from(n.entries()).forEach(e=>{let[t,r]=e;a[t]="string"==typeof r?r.trim():r}),await t(r.action,a,r.method)}e.toKeyValue=function(e){return Array.from(e).reduce((e,t)=>(e[t.name]=t.value||"",e),{})},e.send=t,e.submit=r,document.addEventListener("DOMContentLoaded",()=>{Array.from(document.querySelectorAll("form.ajax")).forEach(t=>{t.addEventListener("submit",async function(t){t.preventDefault();let n=await r(this);if(this.hasAttribute("callback")){let t=this.getAttribute("callback");e[t](n)}})})})}(builder||(builder={})),builder||(builder={}),Array.from(document.querySelectorAll(".toggle-password")).forEach(e=>{let t=e.querySelector(".toggle"),r=e.querySelector("input[type=password]");t.addEventListener("click",e=>e.preventDefault()),r instanceof HTMLInputElement&&"password"==r.type&&t.addEventListener("click",()=>{r.type="password"==r.type?"text":"password";let e=t.querySelector("i");e&&(e.classList.toggle("fa-eye-slash","text"==r.type),e.classList.toggle("fa-eye","password"==r.type))})}),function(e){function t(e){return e.replace(/[^\w\s]+/g,"").replace(/\s/g,"-").replace(/-$/g,"").toLowerCase()}function r(e){let t=e.checkValidity();e.classList.toggle("required",!t)}let n=document.querySelector("#install");n&&n.addEventListener("click",async t=>{t.preventDefault();let r=await e.submit(n.closest("form"));r.error?alert(r.message):window.location.href=REDIRECT_TO});let a=document.querySelector("#test-connection");a&&a.addEventListener("click",async t=>{let r=document.querySelectorAll("input[name^=db-]"),n=await e.send(TEST_CONN,e.toKeyValue(r),"post");n.error?alert(n.message):alert("Connection successful")});let i=document.querySelector("[name=website-title]"),l=document.querySelector("[name=db-database]");i&&l&&(l.value=t(i.value),i.addEventListener("input",function(){l.classList.contains("sync")&&(l.value=t(i.value))}),l.addEventListener("input",function(){l.classList.remove("sync")}));let s=document.querySelector(".re-sync");if(s&&s.addEventListener("click",e=>{e.preventDefault(),l&&l.classList.add("sync"),l&&i&&(l.value=t(i.value)),r(l)}),n){let e=n.closest("form");e&&Array.from(e.querySelectorAll("text,password,email,number".replace(/\w+/g,"input[type=$&]"))).forEach(e=>{r(e),e.addEventListener("input",function(){this.required&&r(e)})})}}(builder||(builder={})),function(e){e.adminLogin=function(e){e.error||(window.location.href=e.location)}}(builder||(builder={})),function(e){let t=Array.from(document.querySelectorAll(".media-filter")),r=-1;t.forEach(n=>{n.addEventListener("click",function(n){n.preventDefault(),clearTimeout(r),this.classList.toggle("active");let a=t.map(e=>e.classList.contains("active")?e.getAttribute("data-type"):"").filter(String);r=setTimeout(()=>{e.send(FILTER_URL,{filter:a},"post")},1e3)})})}(builder||(builder={})),function(e){Array.from(document.querySelectorAll(".trash-delete, .trash-restore")).forEach(t=>{let r,n=t.closest("[data-id]");n&&(r=n.querySelector(".spinner")),t.addEventListener("click",async function(t){if(t.preventDefault(),n){r&&r.classList.remove("hidden"),this.classList.add("hidden");let t=n.getAttribute("data-id");if(t&&t.length>0){let r=this.classList.contains("trash-delete")?TRASH_URL:TRASH_RESTORE_URL;await e.send(r,{id:t},"post"),n.remove()}}})})}(builder||(builder={}));