"use strict";var builder;!function(e){async function t(...e){let t="",r={},n=1==e.length?e[0].method:2==e.length?e[0].method:3==e.length?e[2]:"get",a={method:n,headers:{"X-Requested-With":"XMLHttpRequest"}};if(1==e.length?(t=e[0].action,r=new FormData(e[0])):2!=e.length&&3!=e.length||(t=e[0]instanceof HTMLFormElement?e[0].action:e[0],r=e[1]),"get"==n){if(r instanceof FormData){let e=Array.from(r.entries()).map(([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t.toString())).join("&");e.length>0&&(t+="?"+e)}else if(r instanceof Object){let e=[];for(let t in r){let n=r[t];e.push(encodeURIComponent(t)+"="+encodeURIComponent(n.toString()))}e.length>0&&(t+="?"+e.join("&"))}}else if(r instanceof FormData)a.body=r;else try{a.body=JSON.stringify(r)}catch(e){a.body=""}let i="",l=document.querySelector("meta[name=csrf]");l&&(i=l.content),i.length>0&&(a.headers["X-CSRF-Token"]=i);try{let e=await fetch(t,a),r=await e.text();try{return JSON.parse(r)}catch(e){return r}}catch(e){console.error(e.message)}}async function r(e){let r="string"==typeof e?document.querySelector(e):e;if(r.reportValidity())return await t(r)}e.toKeyValue=function(e){return Array.from(e).reduce((e,t)=>(e[t.name]=t.value||"",e),{})},e.send=t,e.submit=r,Array.from(document.querySelectorAll("form.ajax")).forEach(t=>{t.addEventListener("submit",async function(t){t.preventDefault();let n=await r(this);if(this.hasAttribute("callback")){let t=this.getAttribute("callback");e[t](n)}})})}(builder||(builder={})),builder||(builder={}),Array.from(document.querySelectorAll(".toggle-password")).forEach(e=>{let t=e.querySelector(".toggle"),r=e.querySelector("input[type=password]");t.addEventListener("click",e=>e.preventDefault()),r instanceof HTMLInputElement&&"password"==r.type&&t.addEventListener("click",()=>{r.type="password"==r.type?"text":"password";let e=t.querySelector("i");e&&(e.classList.toggle("fa-eye-slash","text"==r.type),e.classList.toggle("fa-eye","password"==r.type))})}),function(e){function t(e){return e.replace(/[^\w\s]+/g,"").replace(/\s/g,"-").replace(/-$/g,"").toLowerCase()}function r(e){let t=e.checkValidity();e.classList.toggle("required",!t)}let n=document.querySelector("#install");n&&n.addEventListener("click",async t=>{t.preventDefault();let r=await e.submit(n.closest("form"));r.error?alert(r.message):window.location.href=REDIRECT_TO});let a=document.querySelector("#test-connection");a&&a.addEventListener("click",async t=>{let r=document.querySelectorAll("input[name^=db-]"),n=await e.send(TEST_CONN,e.toKeyValue(r),"post");n.error?alert(n.message):alert("Connection successful")});let i=document.querySelector("[name=website-title]"),l=document.querySelector("[name=db-database]");i&&l&&(l.value=t(i.value),i.addEventListener("input",function(){l.classList.contains("sync")&&(l.value=t(i.value))}),l.addEventListener("input",function(){l.classList.remove("sync")}));let o=document.querySelector(".re-sync");if(o&&o.addEventListener("click",e=>{e.preventDefault(),l&&l.classList.add("sync"),l&&i&&(l.value=t(i.value)),r(l)}),n){let e=n.closest("form");e&&Array.from(e.querySelectorAll("text,password,email,number".replace(/\w+/g,"input[type=$&]"))).forEach(e=>{r(e),e.addEventListener("input",function(){this.required&&r(e)})})}}(builder||(builder={})),function(e){e.adminLogin=function(e){e.error||(window.location.href=e.location)}}(builder||(builder={})),function(e){let t=Array.from(document.querySelectorAll(".media-filter")),r=document.querySelector(".media-query-filter input");function n(){let e=t.map(e=>e.classList.contains("active")?e.getAttribute("data-type"):"").filter(String),n=r?r.value:"";Array.from(document.querySelectorAll(".row.media-file")).forEach(t=>{let r=t.getAttribute("data-type")||"",a=t.getAttribute("data-file")||"";e.includes(r)&&a.includes(n)||a.includes(n)&&0==e.length||e.includes(r)&&0==n.length?t.classList.remove("hidden"):t.classList.add("hidden")})}r&&r.addEventListener("input",e=>{e.preventDefault(),n()}),t.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("active"),n()})})}(builder||(builder={})),function(e){Array.from(document.querySelectorAll(".trash-delete, .trash-restore")).forEach(t=>{let r,n=t.closest("[data-id]");n&&(r=n.querySelector(".spinner")),t.addEventListener("click",async function(t){if(t.preventDefault(),n){r&&r.classList.remove("hidden"),this.classList.add("hidden");let t=n.getAttribute("data-id");if(t&&t.length>0){let r=this.classList.contains("trash-delete")?TRASH_URL:TRASH_RESTORE_URL;await e.send(r,{id:t},"post"),n.remove()}}})})}(builder||(builder={})),HTMLElement.prototype.addEventListeners=function(...e){e[0].split(" ").filter(e=>e.trim().length>0).forEach(t=>{this.addEventListener(t,e[1],e[2])})},function(e){Array.from(document.querySelectorAll(".upload-drag-drop")).forEach(t=>{t.addEventListeners("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}),t.addEventListeners("dragover dragenter",function(e){this.classList.add("is-dragover")}),t.addEventListeners("dragleave dragend drop",function(e){this.classList.remove("is-dragover")}),t.addEventListeners("drop",function(r){Array.from(r.dataTransfer.files).forEach(r=>{let n=new FileReader;n.addEventListener("load",async function(n){let a="";if("string"==typeof this.result&&"image"==(a=((this.result.match(/^data:(.+);/)||["",""])[1].split("/")||["",""])[0].trim())){let n=new Image;n.src=this.result;let a=document.querySelector(".upload-preview .preview");a.innerHTML="",a&&a.appendChild(n);let i=new FormData;i.set("path",document.querySelector("input[name=path]").value),i.set("file",r,r.name),await e.send(t,i)}}),n.readAsDataURL(r)})}),t.addEventListener("progress",e=>console.log(e.loaded,e.total));let r=t.querySelector("input[type=file]");if(r){let n=document.querySelector(".upload-preview .preview"),a=Array.from(document.querySelectorAll(".upload-preview .preview-info"));r.addEventListener("change",function(i){r.files instanceof FileList&&Array.from(r.files).forEach(async i=>{let l=new FileReader;l.addEventListener("loadend",async function(e){let t=new Blob([this.result]),r=new Image;r.src=window.URL.createObjectURL(t),n&&(a.forEach(e=>e.classList.add("hidden")),n.classList.remove("hidden"),n.appendChild(r))}),l.readAsArrayBuffer(i);let o=new FormData;o.set("path",document.querySelector("input[name=path]").value),o.set(r.name,i,i.name),await e.send(t,o)})})}})}(builder||(builder={}));