"use strict";define("elemental/Elemental",["require","exports","elemental/Element"],function(e,t,n){function a(e,t){let a;return a=e instanceof n.Element?e:new n.Element(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.tag=a,t.$=function(e){return new i(e)};class i{constructor(e){this.items=[],e instanceof HTMLElement?this.items.push(e):Array.isArray(e)?this.items=e:"string"==typeof e&&(this.items=Array.from(document.querySelectorAll(e)))}dispatch(e){this.items.forEach(t=>e.split(" ").forEach(e=>t.dispatchEvent(new Event(e))))}broadcast(e){let t=[];t.push(...this.items),this.items.forEach(e=>t.push(...Array.from(e.querySelectorAll("*")))),(t=[...new Set(t)]).forEach(t=>e.split(" ").forEach(e=>t.dispatchEvent(new Event(e))))}count(){return this.items.length}find(e){let t=[];return this.items.forEach(n=>t.push(...Array.from(n.querySelectorAll(e)))),this.items=t,this}closest(e){let t,n=[];return this.items.forEach(a=>(t=a.closest(e))&&n.push(t)),this.items=n,this}remove(){return this.items.forEach(e=>e.remove()),this.items=[],this}toggleClass(e,t){let n=[];return n.push(...e.split(" ")),this.items.forEach(e=>n.forEach(n=>e.classList.toggle(n,t))),this}addClass(...e){let t=[];return e.forEach(e=>t.push(...e.split(" "))),this.items.forEach(e=>e.classList.add(...t)),this}removeClass(...e){let t=[];return e.forEach(e=>t.push(...e.split(" "))),this.items.forEach(e=>e.classList.remove(...t)),this}static join(...e){return n.Element.join(...e)}static forEach(e,t){return Array.isArray(e)?n.Element.each(e,t):new n.Element("")}static create(e,t){return a(e)}async ajax(...e){let t="",n={},a="get";a=4==e.length?e[2]:a;let i=e[e.length-1];2==e.length&&e[0]instanceof HTMLFormElement?(t=e[0].action,n=new FormData(e[0])):2==e.length&&"string"==typeof e[0]?t=e[0]:3!=e.length&&4!=e.length||(t=e[0]instanceof HTMLFormElement?e[0].action:e[0],n=e[1]);let r={method:a,headers:{"X-Requested-With":"XMLHttpRequest"}};if("get"==a){if(n instanceof FormData){let e=Array.from(n.entries()).map(([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t.toString())).join("&");e.length>0&&(t+="?"+e)}else if(n instanceof Object){let e=[];for(let t in n){let a=n[t];a&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(a.toString()))}e.length>0&&(t+="?"+e.join("&"))}}else if(n instanceof FormData)r.body=n;else try{r.body=JSON.stringify(n)}catch(e){r.body=""}let l="",s=document.querySelector("meta[name=csrf]");s&&(l=s.content),l.length>0&&(r.headers["X-CSRF-Token"]=l);let o={};try{let e=await fetch(t,r),n=await e.text();try{o=JSON.parse(n)}catch(e){o=n}}catch(e){console.error(e.message)}this.items.forEach(e=>null!==i&&i(o).render(e))}}}),define("elemental/Element",["require","exports","elemental/Elemental"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=function(e,t,...i){let r=[];if(t)for(let e in t)r.push(`[${e}="${t[e]}"]`);let l=e+r.join("")+" "+i.map(e=>"string"==typeof e?e:" ").join("").trim(),s=i.map(e=>e instanceof a?e:null).filter(e=>e instanceof a),o=a.join(...s);return n.tag({tag:l,children:o})};class a{constructor(e){this.el=e}get rootElement(){return this._rootElement}broadcast(e){this._renderedTo instanceof HTMLElement&&n.$(this._renderedTo).broadcast(e)}dispatch(e){this._renderedTo instanceof HTMLElement&&n.$(this._renderedTo).dispatch(e)}render(e){let t=this.setRoot(e);return t?(t.innerHTML="",t.appendChild(this.rootElement),this._renderedTo=t,Array.from(t.querySelectorAll("*")).forEach(e=>e.dispatchEvent(new Event("loaded"))),this):this}append(e){let t=this.setRoot(e);return t?(t.appendChild(this.rootElement),this._renderedTo=t,Array.from(t.querySelectorAll("*")).forEach(e=>e.dispatchEvent(new Event("loaded"))),this):this.el}setRoot(e){let t=document.body;return e&&"string"==typeof e?t=document.querySelector(e):e instanceof a?t=e.rootElement:e&&e instanceof HTMLElement&&(t=e),this.el instanceof HTMLElement||this.el instanceof DocumentFragment?this._rootElement=this.el:this._rootElement=this.makeElement(this.el,t),t}compile(){if(this.el instanceof HTMLElement||this.el instanceof DocumentFragment)return this.el;let e=document.createDocumentFragment();return this._rootElement=this.makeElement(this.el,e),this._rootElement}toString(){if(this.rootElement instanceof HTMLElement)return this.rootElement.innerHTML;if(this.rootElement instanceof DocumentFragment){let e=document.createElement("div");for(let t of this.rootElement.children)e.appendChild(t);return e.innerHTML}return""}static each(e,t){let n=document.createDocumentFragment();for(let a=0;a<e.length;a++){let i=t(e[a],a,e);i.el instanceof HTMLElement||i.el instanceof DocumentFragment?n.appendChild(i.el):n.appendChild(i.makeElement(i.el,n))}return new a(n)}static join(...e){let t=document.createDocumentFragment();for(let n of e)n.el instanceof HTMLElement||n.el instanceof DocumentFragment?t.appendChild(n.el):t.appendChild(n.makeElement(n.el,t));return new a(t)}makeElement(e,t){if(e instanceof HTMLElement||e instanceof DocumentFragment)return t.appendChild(e),e;if(e instanceof a){let n=this.makeElement(e.el,t);return t.appendChild(n),e.el instanceof HTMLElement||e.el instanceof DocumentFragment?e.el:n}if(Array.isArray(e)){let t=document.createDocumentFragment();return e.forEach(e=>this.makeElement(e,t)),t}if("string"!=typeof e){let t=!0;if("function"==typeof e.render?t=e.render():"boolean"==typeof e.render&&(t=e.render),!1===t)return document.createDocumentFragment()}let n="string"==typeof e?e:e.tag?e.tag:"$frag";if(n instanceof a)return this.makeElement(n,t);if("string"==typeof n){let a=n.replace(/\s*\>(?![^[]*])\s*/g,">");if(a.includes(">")){let i=t;return a.split(/\s*\>(?![^[]*])\s*/).forEach(a=>{t=this.makeElement(a,t),n=a,"string"!=typeof e&&e.tag&&(e.tag=a)}),"string"!=typeof e&&e.children&&(Array.isArray(e.children)&&e.children.forEach(e=>{this.makeElement(e,t)}),e&&"object"==typeof e.children&&this.makeElement(e.children,t)),"string"!=typeof e&&t instanceof HTMLElement&&this.addEvents(e,t),"string"!=typeof e&&t instanceof HTMLElement&&this.addChildEvents(e,t),"string"!=typeof e&&t instanceof HTMLElement&&this.addSelectorEvents(e,t),i.firstChild}}let i=this.parseQuerySelector(n),r=i.fragment?document.createDocumentFragment():document.createElement(i.element);if(r instanceof HTMLElement&&(i.id.length>0&&(r.id=i.id),i.classList.length>0&&r.classList.add(...i.classList),i.attributes.forEach(e=>e.key?r instanceof HTMLElement&&r.setAttribute(e.key,e.value):r instanceof HTMLElement&&r.setAttribute(e.value,e.value)),i.properties.forEach(e=>r instanceof HTMLElement&&r.setAttribute(e,e))),t&&t.appendChild(r),"string"==typeof e)i.text.length>0&&this.makeText(i.text,r);else{let t=e.txt&&e.txt.length>0?e.txt:i.text.length>0?i.text:"";t.length>0&&this.makeText(t,r),e&&Array.isArray(e.children)?e.children.forEach(e=>{this.makeElement(e,r)}):e&&["object","string"].includes(typeof e.children)&&this.makeElement(e.children,r)}return void 0!==e&&"string"!=typeof e&&(r instanceof HTMLElement&&this.addEvents(e,r),r instanceof HTMLElement&&this.addChildEvents(e,r),r instanceof HTMLElement&&this.addSelectorEvents(e,r)),r.dispatchEvent(new Event("rendered")),r}makeText(e,t){let n=e;e=e.replace(/\#\{(.+?)\}/g,(e,t)=>this.makeElement(t,document.createDocumentFragment()).outerHTML),t instanceof HTMLElement&&n!=e?t.innerHTML=e:t.appendChild(document.createTextNode(e))}addEvents(...e){let t=2==e.length?e[0]:null,n=1==e.length?e[0]:e[1];if(t&&t.events){for(let e in t.events){let a=t.events[e];if(["function","string"].includes(typeof a)){if("function"==typeof a)n.addEventListener(e,a.bind(n));else if("string"==typeof a){let t=a.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,window);t&&n.addEventListener(e,t.bind(n))}"visibility"==e&&new IntersectionObserver(t=>{for(let n of t)n.target.dispatchEvent(new Event(e))}).observe(n)}}n.dispatchEvent(new Event("created"))}}addSelectorEvents(...e){let t=2==e.length?e[0]:null,n=1==e.length?e[0]:e[1];if(t&&t.events&&t.events.$selector)for(let e in t.events.$selector){let a=t.events.$selector[e];Array.from(n.querySelectorAll(a.selector)).forEach(t=>{t.addEventListener(e,a.event)})}}addChildEvents(...e){let t=2==e.length?e[0]:null,n=1==e.length?e[0]:e[1];if(t&&t.events&&t.events.$children){let e=Array.from(n.children);for(let n in t.events.$children){let a=t.events.$children[n];["function","string"].includes(typeof a)&&e.forEach(e=>{if("function"==typeof a)e.addEventListener(n,a.bind(e));else if("string"==typeof a){let t=a.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,window);t&&e.addEventListener(n,t.bind(e))}})}e.forEach(e=>e.dispatchEvent(new Event("rendered")))}}parseQuerySelector(e){let t={classList:[],id:"",element:"div",fragment:!1,attributes:[],properties:[],text:""},n=e.replace(/\s*\>(?![^[]*])\s*/g,">").replace(/\s+(?![^[]*]).+/,"").trim();return t.text=(e.match(/\s+(?![^[]*]).+/)||[""])[0].trim(),t.id=(n.match(/#[\w-_]+(?![^[]*])/)||[""])[0].replace("#",""),t.classList=(n.match(/\.[\w-_]+(?![^[]*])/g)||[]).map(e=>e.replace(".","")),t.element=n.toLowerCase().split(/[^a-z0-9]/,2)[0]||"div",(n.startsWith("$frag")||n.startsWith("$fragment"))&&(t.fragment=!0),t.attributes=(n.match(/\[.+?\]/g)||[]).reduce((e,t)=>{let n=t.split("="),a=n.shift(),i=n.join("=");return a=a||"",i=i||"",e.concat({key:a.replace(/^\[|\]$/g,""),value:i.replace(/\]$/g,"").replace(/^('|")/,"").replace(/('|")$/,"")})},[]),t.properties=(n.match(/:\w+(?![^[]*])/g)||[]).reduce((e,t)=>e.concat(t.replace(/^:/,"")),[]),t}}t.Element=a}),define("ajax",["require","exports"],function(e,t){async function n(...e){let t="",n={},a=1==e.length&&e[0]instanceof HTMLElement?e[0].method:2==e.length&&e[0]instanceof HTMLFormElement?e[0].method:2==e.length&&"string"==typeof e[0]?"get":3==e.length?e[2]:"get",i={method:a,headers:{"X-Requested-With":"XMLHttpRequest"}};if(1==e.length&&e[0]instanceof HTMLFormElement?(t=e[0].action,n=new FormData(e[0])):1==e.length&&"string"==typeof e[0]?(t=e[0],a="get"):2!=e.length&&3!=e.length||(t=e[0]instanceof HTMLFormElement?e[0].action:e[0],n=e[1]),"get"==a){if(n instanceof FormData){let e=Array.from(n.entries()).map(([e,t])=>encodeURIComponent(e)+"="+encodeURIComponent(t.toString())).join("&");e.length>0&&(t+="?"+e)}else if(n instanceof Object){let e=[];for(let t in n){let a=n[t];a&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(a.toString()))}e.length>0&&(t+="?"+e.join("&"))}}else if(n instanceof FormData)i.body=n;else try{i.body=JSON.stringify(n)}catch(e){i.body=""}let r="",l=document.querySelector("meta[name=csrf]");l&&(r=l.content),r.length>0&&(i.headers["X-CSRF-Token"]=r);try{let e=await fetch(t,i),n=await e.text();try{return JSON.parse(n)}catch(e){return n}}catch(e){console.error(e.message)}return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.toKeyValue=function(e){return Array.from(e).reduce((e,t)=>(e[t.name]=t.value||"",e),{})},t.send=n,t.submit=async function(e){let t="string"==typeof e?document.querySelector(e):e;if(t.reportValidity())return await n(t)}}),HTMLElement.prototype.addEventListeners=function(...e){e[0].split(" ").filter(e=>e.trim().length>0).forEach(t=>{this.addEventListener(t,e[1],e[2])})};const routes={data:[],get(e,t=""){let n=this.data.find(t=>t.name==e);return n&&n.path||t},is(e){let t=window.location.pathname;return!!this.data.find(n=>n.name==e&&n.path==t)},when(e,t="",n=""){let a=window.location.pathname;return this.data.find(t=>t.name==e&&t.path==a)?t:n}};var builder;requirejs(["ajax"],function(e){Array.from(document.querySelectorAll("form.ajax")).forEach(t=>{t.addEventListener("submit",async function(t){t.preventDefault();let n=await e.submit(this);if(this.hasAttribute("callback")){let e=this.getAttribute("callback");builder[e](n)}})}),e.send("/admin/api/routes/list").then(e=>{routes.data=e,console.log(e),requirejs(["templates/admin/nav"],function(e){e.mainNav(routes).render("#main-nav");let t=document.querySelector("[data-app]");if(t){let e=t.getAttribute("data-app");e&&requirejs([`components/${e}`],function(e){e&&e.load&&e.load()})}})})}),define("templates/admin/media",["require","exports","components/media","ajax","elemental/Elemental","elemental/Element","templates/helper"],function(e,t,n,a,i,r,l){function s(){let e=(window.location.search.replace(/^\?/,"").split("&").find(e=>e.startsWith("path="))||"").match(/(.+?)=(.+)/);return(e&&e[2]?e[2]:"").split("/")}function o(e){return i.tag([{render:e.length>0,tag:"p.fluid.row.text-bold",children:["span.col-1.text-center Actions","span.col-1.text-center Info","span.col-2 Date Uploaded","span.col-2 File Size"]},r.Element.each(e,(e,t)=>i.tag({tag:`p.fluid.row[data-id=${e._id}]`,children:[{tag:"span.col-1.text-center",children:{tag:"span.margin-right-5",children:[{tag:"a[title=\"Move to trash\"][href=''].trash-delete.red-text",children:"i.fa-lg.fa-fw.far.fa-trash-alt"},{tag:"span.spinner.hidden",children:"i.fa-lg.fa-fw.fas.fa-spin.fa-sync"}]}},{tag:"span.col-1.text-center",children:{render:0==t,tag:"span.label.label-info current"}},`span.col-2 ${new Date(e.uploadDate).toLocaleString("en-US")}`,`span.col-2[title=${String(e.length).replace(/\B(?=(\d{3})+(?!\d))/g,",")} Bytes] ${l.bytesToSize(e.length)}`]}))])}Object.defineProperty(t,"__esModule",{value:!0}),t.makeFilter=function(){let e=-1;return i.tag({children:[{tag:".fluid.row",children:[{tag:".col.media-query-filter",children:[{tag:'input[type="text"][placeholder="Search"]',events:{input(t){t.preventDefault(),clearTimeout(e),e=setTimeout(n.updateStateAndApplyFilter,300)},loaded(){let e=(window.location.search.replace(/^\?/,"").split("&").find(e=>e.startsWith("query="))||"").match(/(.+?)=(.+)/);this.value=(e&&e[2]?e[2]:"").trim(),n.updateStateAndApplyFilter()}}},"i.fas.fa-search.fa-3x"]}]},{tag:".fluid.row",events:{$children:{click(e){e.preventDefault(),i.$(this).toggleClass("active"),n.updateStateAndApplyFilter()}}},children:['a[href=""][data-type="image"].col.media-filter.image-filter Images','a[href=""][data-type="video"].col.media-filter.video-filter Videos','a[href=""][data-type="audio"].col.media-filter.audio-filter Audio','a[href=""][data-type="font"].col.media-filter.compress-filter Fonts','a[href=""][data-type="application"].col.media-filter.other-filter Apps']}]})},t.makeDirectoryListing=function(e){return i.tag([{tag:"p.fluid.row.text-bold",render:s().length>2||e.length>0,children:["span.col-1.text-center Actions","span.col-3 Folder"]},{tag:"p.fluid.row.up-level",render:s().length>2,children:["span.col-1",{tag:"span.col-3",children:{tag:'a[href=""]',events:{click(e){e.preventDefault();let t=s().slice(0,s().length-1).join("/");n.openDirectory(t)}},children:["i.fas.fa-fw.fa-level-up-alt","span Up one level"]}}]},r.Element.each(e,e=>i.tag({tag:`p.fluid.row[data-directory=${e.directory}]`,children:[{tag:"span.col-1.text-center",children:{tag:"span.margin-horizontal-5",children:[{tag:'a[title="Move to trash"][href=""].trash-delete.red-text',events:{async click(e){e.preventDefault();let t=this.closest("p.row");if(t){let e=t.getAttribute("data-directory");i.$(this).addClass("hidden").closest(".row").broadcast("spin"),await a.send(routes.get("api-admin-delete-media"),{directory:e},"post"),i.$(this).closest(".row").remove()}}},children:"i.fa-lg.fa-fw.far.fa-trash-alt"},{tag:"span.spinner.hidden",events:{spin(){i.$(this).removeClass("hidden")}},children:"i.fa-lg.fa-fw.fas.fa-spin.fa-sync"}]}},{tag:"span.col-3.overflow-ellipsis",events:{$children:{click(e){e.preventDefault();let t=this.getAttribute("data-path")||"";n.openDirectory(t)}}},children:`a.directory-item[href='?path=${e.directory}'][data-path='${e.directory}'][title='${e.nextDirectory}'] ${e.nextDirectory}`}]}))])},t.makeFileListing=function(e){return i.tag({children:[{tag:"p.fluid.row.text-bold",children:["span.col-1.text-center Actions","span.col-3 Filename","span.col-2 Number of Files","span.col-2 Size of Files"]},{tag:"p.fluid.row",children:{tag:"span.col-12.filter-count",events:{loaded:()=>i.$(".filter-count").dispatch("update"),update(){let e=i.$(".media-file.hidden").count();e>0?(this.parentElement&&this.parentElement.classList.remove("hidden"),this.textContent=1==e?`${e} file has`:`${e} files have`,this.textContent+=" been hidden with this filter"):this.parentElement&&this.parentElement.classList.add("hidden")}}}},r.Element.each(e,e=>i.tag({tag:`p.fluid.row.media-file[data-filename='${e.filename}'][data-file='${e.file}'][data-type='${e.metadata.type}']`,events:{visibility:()=>i.$(".filter-count").dispatch("update")},children:[{tag:"span.col-1.text-center",children:[{tag:"span",children:{tag:'a[title="Move to trash"][href=""].trash-delete.red-text.margin-horizontal-5',events:{async click(e){e.preventDefault();let t=this.closest("p.row");if(t){let e=t.getAttribute("data-filename");i.$(this).addClass("hidden").closest(".row").broadcast("spin hide"),await a.send(routes.get("api-admin-delete-media"),{file:e},"post"),i.$(this).closest(".row").remove()}}},children:"i.fa-lg.fa-fw.far.fa-trash-alt"}},{tag:"span.spinner.hidden.margin-horizontal-5",events:{spin(){i.$(this).removeClass("hidden")}},children:"i.fa-lg.fa-fw.fas.fa-spin.fa-sync"},{tag:"span.preview",events:{hide(){i.$(this).addClass("hidden")}},children:{tag:`a[href=${e.filename}][target="_blank"].margin-horizontal-5`,children:"i.fa-lg.fa-fw.far.fa-eye"}}]},{tag:"span.col-3.overflow-ellipsis",events:{$children:{click(t){t.preventDefault(),i.$("#media-listings").ajax(routes.get("api-admin-media-file"),{file:e.filename},e=>o(e))}}},children:`a[href='${routes.get("api-admin-media-file")}?file=${e.filename}'][title='${e.filename}'] ${e.file}`},`span.col-2 ${e.files}`,`span.col-2 ${l.bytesToSize(e.size)}`]}))]})},t.fileDetails=o}),define("components/media",["require","exports","templates/helper","templates/admin/media","elemental/Elemental","elemental/Element"],function(e,t,n,a,i,r){let l;async function s(e){i.$("#media-listings").ajax(routes.get("api-admin-media-files"),{path:e},"get",t=>(c(e),r.Element.join(a.makeDirectoryListing(t.directories),a.makeFileListing(t.files))))}Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(){n.loadPage("media");let e=(window.location.search.replace(/^\?/,"").split("&").find(e=>e.startsWith("path="))||"").match(/(.+?)=(.+)/);l=e&&e[2]?e[2]:"",a.makeFilter().render("#media-filters"),s(l)},window.addEventListener("popstate",async e=>{e.preventDefault();let t=window.location.search.replace(/^\?/,"").split("&").find(e=>e.startsWith("path="));t&&(t=t.split("=").pop()),t&&s(t)}),t.openDirectory=s;let o=!1;function c(e){if(o)return;o=!0;let t=h(),n=f(),a=[],i=e||(l||"");i.length>0&&a.push(`path=${i}`),n.length>0&&a.push(`query=${n}`),t.length>0&&a.push(`types=${t.join(",")}`),history.pushState({},"",(a.length>0?"?":window.location.pathname)+a.join("&")),o=!1}function d(){let e=h(),t=f();Array.from(document.querySelectorAll(".media-file")).forEach(n=>{let a=n.getAttribute("data-type")||"",i=n.getAttribute("data-file")||"";e.includes(a)&&i.includes(t)||i.includes(t)&&0==e.length||e.includes(a)&&0==t.length?n.classList.remove("hidden"):n.classList.add("hidden")})}function f(){let e=document.querySelector(".media-query-filter input");return e?e.value:""}function h(){return Array.from(document.querySelectorAll(".media-filter")).map(e=>e.classList.contains("active")?e.getAttribute("data-type"):"").filter(String)}t.updateState=c,t.updateStateAndApplyFilter=function(){c(),d()},t.applyFilter=d,t.getPath=function(){let e=(window.location.search.replace(/^\?/,"").split("&").find(e=>e.startsWith("path="))||"").match(/(.+?)=(.+)/);return e&&e[2]?e[2]:""}}),define("templates/admin/pages",["require","exports","elemental/Elemental","elemental/Element"],function(e,t,n,a){Object.defineProperty(t,"__esModule",{value:!0}),t.makePage=function(e){return n.tag({tag:".well",children:[{tag:"p.fluid.row.text-bold",children:["span.col-1.text-center Actions","span.col-2 Title","span.col-2 path","span.col-2 Created","span.col-2 Updated"]},a.Element.each(e,e=>n.tag({tag:`p.fluid.row[data-page=${e.path}]`,children:[{tag:"span.col-1.text-center",children:[{tag:"a[href=''][title='Edit'].margin-horizontal-5",children:"i.fa-lg.fa-fw.far.fa-edit"},{tag:`a[href='${e.path}'][title='Preview'][target='_blank'].margin-horizontal-5`,children:"i.fa-lg.fa-fw.far.fa-eye"},{tag:"a[href=''][title='Move to trash'].margin-horizontal-5.red-text",children:"i.fa-lg.fa-fw.far.fa-trash-alt",events:{async click(e){e.preventDefault(),n.$(this).closest(".row").broadcast("spinnerTrash hideTrash")},hideTrash(){n.$(this).addClass("hidden")}}},{tag:"span.spinner.margin-horizontal-5.hidden",children:"i.fa-lg.fa-fw.fas.fa-spin.fa-sync",events:{spinnerTrash(){n.$(this).removeClass("hidden")}}}]},`span.col-2 ${e.title}`,`span.col-2 ${e.path}`,`span.col-2 ${new Date(e.createDate).toLocaleString("en-US")}`,`span.col-2 ${new Date(e.updateDate).toLocaleString("en-US")}`]}))]})}}),define("templates/admin/home",["require","exports","elemental/Elemental"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.makeHome=function(){return n.tag([".well>h1 Welcome"])}}),define("templates/admin/trash",["require","exports","elemental/Elemental","elemental/Element","templates/helper","ajax"],function(e,t,n,a,i,r){async function l(e){e.preventDefault();let t=e.currentTarget,n=t.closest("[data-id]"),a=null;if(n&&(a=n.querySelector(".spinner")),n){let e=n.getAttribute("data-id");if(e&&e.length>0){a&&a.classList.remove("hidden"),t.classList.add("hidden");let i=t.classList.contains("trash-delete")?routes.get("api-admin-delete-media"):routes.get("api-admin-restore-media");await r.send(i,{id:e},"post"),n.remove()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeTrash=function(e){return n.tag([{tag:".well",events:{$selector:{click:{selector:".trash-restore",event:l}}},children:[{render:e.length>0,tag:"p.row.text-bold",children:["span.col-1.text-center Actions","span.col-3 Filename","span.col-2 Date Uploaded","span.col-2 Date Deleted","span.col-2 File Size"]},{render:0==e.length,tag:"div The trash is empty!"},a.Element.each(e,e=>n.tag({tag:`p.row[data-id="${e.restore_id}"]`,children:[{tag:"span.col-1.text-center",children:[{tag:"span",children:['a[title="Purge from trash"][href=""].trash-purge.light-blue-text.margin-horizontal-5>i.fa-lg.fa-fw.far.fa-times-circle.red-text',"span.spinner.hidden.margin-horizontal-5>i.fa-lg.fa-fw.fas.fa-spin.fa-sync"]},{tag:"span",children:['a[title="Restore from trash"][href=""].trash-restore.light-blue-text.margin-horizontal-5>i.fa-lg.fa-fw.fas.fa-undo-alt',"span.spinner.hidden.margin-horizontal-5>i.fa-lg.fa-fw.fas.fa-spin.fa-sync"]}]},"span.col-3.overflow-ellipsis "+e.data.filename,"span.col-2 "+new Date(e.data.uploadDate).toLocaleString("en-US"),"span.col-2 "+new Date(e.deleteDate).toLocaleString("en-US"),`span.col-2>span[title="${String(e.data.length).replace(/\B(?=(\d{3})+(?!\d))/g,",")} Bytes"] `+i.bytesToSize(e.data.length)]}))]}])}}),define("templates/helper",["require","exports","elemental/Elemental","templates/admin/media","elemental/Element","templates/admin/pages","templates/admin/home","templates/admin/trash"],function(e,t,n,a,i,r,l,s){Object.defineProperty(t,"__esModule",{value:!0}),t.loadPage=function(e){switch(e){case"home":return l.makeHome().render("#primary-content"),!0;case"media":return n.$("#primary-content").ajax(routes.get("api-admin-media-files"),e=>i.Element.join(a.makeFilter(),n.tag({tag:".well#media-listings",children:[a.makeDirectoryListing(e.directories),a.makeFileListing(e.files)]}))),!0;case"pages":return n.$("#primary-content").ajax(routes.get("api-admin-pages"),e=>r.makePage(e)),!0;case"trash":return n.$("#primary-content").ajax(routes.get("api-admin-trash"),e=>s.makeTrash(e)),!0}return!1},t.bytesToSize=function(e){return e/1024/1024/1024/1024/1024>1?(e/1024/1024/1024/1024/1024).toFixed(2)+" PB":e/1024/1024/1024/1024>1?(e/1024/1024/1024/1024).toFixed(2)+" TB":e/1024/1024/1024>1?(e/1024/1024/1024).toFixed(2)+" GB":e/1024/1024>1?(e/1024/1024).toFixed(2)+" MB":e/1024>1?(e/1024).toFixed(2)+" KB":e+" Bytes"}}),define("components/home",["require","exports","templates/helper"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(){n.loadPage("home")}}),define("components/install",["require","exports","ajax"],function(e,t,n){function a(e){return e.replace(/[^\w\s]+/g,"").replace(/\s/g,"-").replace(/-$/g,"").toLowerCase()}function i(e){let t=e.checkValidity();e.classList.toggle("required",!t)}Object.defineProperty(t,"__esModule",{value:!0});let r=document.querySelector("#install");r&&r.addEventListener("click",async e=>{e.preventDefault();let t=await n.submit(r.closest("form"));t.error?alert(t.message):window.location.href=REDIRECT_TO});let l=document.querySelector("#test-connection");l&&l.addEventListener("click",async e=>{let t=document.querySelectorAll("input[name^=db-]"),a=await n.send(TEST_CONN,n.toKeyValue(t),"post");a.error?alert(a.message):alert("Connection successful")});let s=document.querySelector("[name=website-title]"),o=document.querySelector("[name=db-database]");s&&o&&(o.value=a(s.value),s.addEventListener("input",function(){o.classList.contains("sync")&&(o.value=a(s.value))}),o.addEventListener("input",function(){o.classList.remove("sync")}));let c=document.querySelector(".re-sync");if(c&&c.addEventListener("click",e=>{e.preventDefault(),o&&o.classList.add("sync"),o&&s&&(o.value=a(s.value)),i(o)}),r){let e=r.closest("form");e&&Array.from(e.querySelectorAll("text,password,email,number".replace(/\w+/g,"input[type=$&]"))).forEach(e=>{i(e),e.addEventListener("input",function(){this.required&&i(e)})})}}),function(e){e.adminLogin=function(e){e.error||(window.location.href=e.location)}}(builder||(builder={})),define("components/pages",["require","exports","templates/helper"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(){n.loadPage("pages")}}),builder||(builder={}),Array.from(document.querySelectorAll(".toggle-password")).forEach(e=>{let t=e.querySelector(".toggle"),n=e.querySelector("input[type=password]");t.addEventListener("click",e=>e.preventDefault()),n instanceof HTMLInputElement&&"password"==n.type&&t.addEventListener("click",()=>{n.type="password"==n.type?"text":"password";let e=t.querySelector("i");e&&(e.classList.toggle("fa-eye-slash","text"==n.type),e.classList.toggle("fa-eye","password"==n.type))})}),define("components/trash",["require","exports","templates/helper"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(){n.loadPage("trash")}}),define("components/upload",["require","exports","ajax"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),Array.from(document.querySelectorAll(".upload-drag-drop")).forEach(e=>{e.addEventListeners("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}),e.addEventListeners("dragover dragenter",function(){this.classList.add("is-dragover")}),e.addEventListeners("dragleave dragend drop",function(){this.classList.remove("is-dragover")}),e.addEventListeners("drop",function(t){Array.from(t.dataTransfer.files).forEach(t=>{let a=new FileReader;a.addEventListener("load",async function(a){let i="";if("string"==typeof this.result&&"image"==(i=((this.result.match(/^data:(.+);/)||["",""])[1].split("/")||["",""])[0].trim())){let a=new Image;a.src=this.result;let i=document.querySelector(".upload-preview .preview");i.innerHTML="",i&&i.appendChild(a);let r=new FormData;r.set("path",document.querySelector("input[name=path]").value),r.set("file",t,t.name),await n.send(e,r)}}),a.readAsDataURL(t)})}),e.addEventListener("progress",e=>console.log(e.loaded,e.total));let t=e.querySelector("input[type=file]");if(t){let a=document.querySelector(".upload-preview .preview"),i=Array.from(document.querySelectorAll(".upload-preview .preview-info"));t.addEventListener("change",function(r){t.files instanceof FileList&&Array.from(t.files).forEach(async r=>{let l=new FileReader;l.addEventListener("loadend",async function(e){let t=new Blob([this.result]),n=new Image;n.src=window.URL.createObjectURL(t),a&&(i.forEach(e=>e.classList.add("hidden")),a.classList.remove("hidden"),a.appendChild(n))}),l.readAsArrayBuffer(r);let s=new FormData;s.set("path",document.querySelector("input[name=path]").value),s.set(t.name,r,r.name),await n.send(e,s)})})}})}),define("templates/admin/nav",["require","exports","elemental/Elemental","templates/helper"],function(e,t,n,a){function i(e){e.preventDefault();let t=e.currentTarget;a.loadPage(t.getAttribute("data-tpl")||"")&&(window.history.pushState({},"",t.href||"/"),n.$(t).closest("ul").find("li").removeClass("active"),n.$(t).closest("li").addClass("active"))}Object.defineProperty(t,"__esModule",{value:!0}),t.mainNav=function(e){return n.tag({tag:"nav.main>ul",events:{$selector:{click:{selector:"li > a",event:i}}},children:[`li[class="${e.when("admin-home","active")}"]>a[href="${e.get("admin-home")}"][data-tpl="home"] #{i.fa-lg.fas.fa-fw.fa-home} Home`,`li[class="${e.when("admin-pages","active")}"]>a[href="${e.get("admin-pages")}"][data-tpl="pages"] #{i.fa-lg.fas.fa-fw.fa-columns} Pages`,{tag:`li[class="${e.when("admin-media","active")}"]>a[href="${e.get("admin-media")}"][data-tpl="media"]`,events:{$children:{click:i}},children:[{tag:"span.fa-layers.fa-fw.fa-lg",children:['i.fas.fa-music[data-fa-transform="down-3 right-3"]','i.fas.fa-camera[data-fa-transform="up-3 left-3"]']},"span Media"]},`li[class="${e.when("admin-themes","active")}"]>a[href="${e.get("admin-themes")}"]\n        #{i.fa-lg.fas.fa-fw.fa-palette} Themes`,`li[class="${e.when("admin-components","active")}"]>a[href="${e.get("admin-components")}"] #{i.fa-lg.fas.fa-fw.fa-puzzle-piece} Components`,`li[class="${e.when("admin-plugins","active")}"]>a[href="${e.get("admin-plugins")}"] #{i.fa-lg.fas.fa-fw.fa-plug} Plugins`,`li[class="${e.when("admin-comments","active")}"]>a[href="${e.get("admin-comments")}"] #{i.fa-lg.fas.fa-fw.fa-comments} Comments`,`li[class="${e.when("admin-tools","active")}"]>a[href="${e.get("admin-tools")}"] #{i.fa-lg.fas.fa-fw.fa-wrench} Tools`,`li[class="${e.when("admin-settings","active")}"]>a[href="${e.get("admin-settings")}"] #{i.fa-lg.fas.fa-fw.fa-cog} Settings`,`li[class="${e.when("admin-trash","active")}"]>a[href="${e.get("admin-trash")}"][data-tpl="trash"] #{i.fa-lg.fas.fa-fw.fa-trash-alt} Trash`,`li[class="${e.when("admin-logout","active")}"]>a[href="${e.get("admin-logout")}"] #{i.fa-lg.fas.fa-fw.fa-power-off} Logout`]})}});